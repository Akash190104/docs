"use strict";(self.webpackChunkdevops_extensions_docs=self.webpackChunkdevops_extensions_docs||[]).push([[4966],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return c}});var a=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var u=a.createContext({}),o=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=o(e.components);return a.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,r=e.originalType,u=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=o(n),c=s,k=m["".concat(u,".").concat(c)]||m[c]||d[c]||r;return n?a.createElement(k,l(l({ref:t},p),{},{components:n})):a.createElement(k,l({ref:t},p))}));function c(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var r=n.length,l=new Array(r);l[0]=m;var i={};for(var u in t)hasOwnProperty.call(t,u)&&(i[u]=t[u]);i.originalType=e,i.mdxType="string"==typeof e?e:s,l[1]=i;for(var o=2;o<r;o++)l[o]=n[o];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5745:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return u},default:function(){return c},frontMatter:function(){return i},metadata:function(){return o},toc:function(){return d}});var a=n(7462),s=n(3366),r=(n(7294),n(3905)),l=["components"],i={},u="Pull Request Status",o={unversionedId:"extensions/pull-request-utils/tasks/pull-request-status",id:"extensions/pull-request-utils/tasks/pull-request-status",title:"Pull Request Status",description:"PullRequestStatus allows you to create custom statuses for your pull request. See the status policy docs for more infomation.",source:"@site/docs/extensions/pull-request-utils/tasks/pull-request-status.md",sourceDirName:"extensions/pull-request-utils/tasks",slug:"/extensions/pull-request-utils/tasks/pull-request-status",permalink:"/docs/extensions/pull-request-utils/tasks/pull-request-status",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"pullRequestUtils",previous:{title:"Pull Request Description",permalink:"/docs/extensions/pull-request-utils/tasks/pull-request-description"},next:{title:"Pull Request Tags",permalink:"/docs/extensions/pull-request-utils/tasks/pull-request-tags"}},p={},d=[{value:"YAML Snippet",id:"yaml-snippet",level:2},{value:"Arguments",id:"arguments",level:2},{value:"Examples",id:"examples",level:2},{value:"Create and update status",id:"create-and-update-status",level:3},{value:"Conditionally update status",id:"conditionally-update-status",level:3}],m={toc:d};function c(e){var t=e.components,n=(0,s.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"pull-request-status"},"Pull Request Status"),(0,r.kt)("p",null,"PullRequestStatus allows you to create custom statuses for your pull request. See the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/devops/repos/git/pull-request-status?view=azure-devops#status-policy"},"status policy")," docs for more infomation."),(0,r.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"If using classic pipelines and you get the error:"),(0,r.kt)("blockquote",{parentName:"div"},(0,r.kt)("p",{parentName:"blockquote"},"TF400813: The user '' is not authorized to access this resource.")),(0,r.kt)("p",{parentName:"div"},"Ensure ",(0,r.kt)("inlineCode",{parentName:"p"},"Allow scripts to access the OAuth token")," is checked under options. See the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/devops/pipelines/build/options?view=azure-devops#allow-scripts-to-access-the-oauth-token"},"docs")," for more info."))),(0,r.kt)("h2",{id:"yaml-snippet"},"YAML Snippet"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"- task: PullRequestStatus@0\n  inputs:\n    action: Create\n    name: my-custom-gate #Name of the status. Full status will be `pull-request-utils/<name>`\n    description: #Status description. Normally describes the current state of the status.\n    state: notSet\n    useDefined: false #If set, overrides the value from `System.PullRequest.PullRequestId`\n    pullRequestId: $(System.PullRequest.PullRequestId) #If no id is given, the value from `System.PullRequest.PullRequestId` is taken. If a value is given, this overrides the value from `System.PullRequest.PullRequestId`\n    whenState: #Only update the state of the status when the existing state is one of these\n\n")),(0,r.kt)("h2",{id:"arguments"},"Arguments"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Argument"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"action")," ",(0,r.kt)("br",null),"Action"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"(Required)")," ",(0,r.kt)("br",null)," Options: ",(0,r.kt)("inlineCode",{parentName:"td"},"Create"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"Update"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"Delete")," ",(0,r.kt)("br",null)," Default value: ",(0,r.kt)("inlineCode",{parentName:"td"},"Create"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"name")," ",(0,r.kt)("br",null),"Name"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"(Required)")," Name of the status. Full status will be ",(0,r.kt)("inlineCode",{parentName:"td"},"pull-request-utils/<name>")," ",(0,r.kt)("br",null)," Default value: ",(0,r.kt)("inlineCode",{parentName:"td"},"my-custom-gate"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"description")," ",(0,r.kt)("br",null),"Description"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"(Optional)")," Status description. Normally describes the current state of the status. ",(0,r.kt)("br",null))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"state")," ",(0,r.kt)("br",null),"State"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"(Required)")," ",(0,r.kt)("br",null)," Options: ",(0,r.kt)("inlineCode",{parentName:"td"},"notSet"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"error"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"failed"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"notApplicable"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"pending"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"succeeded")," ",(0,r.kt)("br",null)," Default value: ",(0,r.kt)("inlineCode",{parentName:"td"},"notSet"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"useDefined")," ",(0,r.kt)("br",null),"Use defined id"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"(Optional)")," If set, overrides the value from ",(0,r.kt)("inlineCode",{parentName:"td"},"System.PullRequest.PullRequestId")," ",(0,r.kt)("br",null))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pullRequestId")," ",(0,r.kt)("br",null),"Pull Request Id"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"(Optional)")," If no id is given, the value from ",(0,r.kt)("inlineCode",{parentName:"td"},"System.PullRequest.PullRequestId")," is taken. If a value is given, this overrides the value from ",(0,r.kt)("inlineCode",{parentName:"td"},"System.PullRequest.PullRequestId")," ",(0,r.kt)("br",null)," Default value: ",(0,r.kt)("inlineCode",{parentName:"td"},"$(System.PullRequest.PullRequestId)"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"whenState")," ",(0,r.kt)("br",null),"When current status is in state"),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("strong",{parentName:"td"},"(Optional)")," Only update the state of the status when the existing state is one of these ",(0,r.kt)("br",null)," Options: ",(0,r.kt)("inlineCode",{parentName:"td"},"notSet"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"error"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"failed"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"notApplicable"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"pending"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"succeeded")," ",(0,r.kt)("br",null))))),(0,r.kt)("h2",{id:"examples"},"Examples"),(0,r.kt)("h3",{id:"create-and-update-status"},"Create and update status"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"steps:\n  - task: PullRequestStatus@0\n    displayName: 'Initialize status'\n    inputs:\n      name: 'my-custom-check'\n      action: 'Create'\n      state: 'pending'\n      description: 'Awaiting my custom check'\n  - script: 'echo Do something'\n  - task: PullRequestStatus@0\n    displayName: 'Update status'\n    inputs:\n      name: 'my-custom-check'\n      action: 'Update'\n      state: 'succeeded'\n      description: 'Check passed'\n\n")),(0,r.kt)("h3",{id:"conditionally-update-status"},"Conditionally update status"),(0,r.kt)("p",null,"A status can be conditionally updated by using the ",(0,r.kt)("inlineCode",{parentName:"p"},"whenState")," argument. This will first check that the current status is in one of the given states before it updates."),(0,r.kt)("p",null,"For the example below, it will only update the status if it is in one of the following states:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Error"),(0,r.kt)("li",{parentName:"ul"},"Failed"),(0,r.kt)("li",{parentName:"ul"},"Pending")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"- task: PullRequestStatus@0\n  displayName: 'Initialize status'\n  inputs:\n    name: 'my-custom-check'\n    action: 'Create'\n    state: 'pending'\n    description: 'Awaiting my custom check'\n- script: 'echo Do something. It might even update the status'\n- task: PullRequestStatus@0\n  displayName: 'Update status'\n  inputs:\n    name: 'my-custom-check'\n    action: 'Update'\n    state: 'succeeded'\n    description: 'Check passed'\n    whenState: 'error, failed, pending'\n")))}c.isMDXComponent=!0}}]);